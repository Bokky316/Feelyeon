<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>필연 : 必然 - 장바구니</title>
    <th:block layout:fragment="css">
    <link href="css/cart.css" rel="stylesheet">
    <link href="css/header_bg.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    </th:block>
</head>
<body>
    <!-- 베이지색 헤더 나중에 분리하기/ html, css 파일 별도 지정해둠, css는 link 걸어두었으므로 html만 분리하면 됨 -->
    <header>
        <div class="categories" id="menuToggle"><i class="fas fa-bars"></i></div>
        <div class="side-menu" id="sideMenu">
            <ul>
                <li><a href="index.html">Home</a></li>
                <li>About</li>
                <li>Services</li>
                <li>Contact</li>
            </ul>
        </div>
        <a href="index.html" class="logo"><img th:src="@{/static-images/logo_bg.png" alt="logo"></a>
        <div class="nav header-btns">
            <a href="#">SIGN UP</a>
            <a href="#">LOGIN</a>
            <a href="#">CART</a>
        </div>
    </header>

    <h2>CART</h2>
    <main class="cart-container">
        <section class="cart-items">
            <div class="select-all-container">
                <input type="checkbox" id="select-all">
                <label for="select-all" class="checkbox-label">전체 선택</label>
            </div>
            <div class="cart-item">
                <input type="checkbox" class="item-select">
                <img th:src="@{/static-images/product/012.png" alt="상품 이미지">
                <div class="item-info">
                    <p class="item-name">블랙윙 연필 Blackwing Vol.574</p>
                    <p class="item-price">56,000원</p>
                    <p class="item-option">[옵션: 1 dozen]</p>
                    <div class="quantity-control">
                        <button class="quantity-btn minus">–</button>
                        <span class="quantity">1</span>
                        <button class="quantity-btn plus">+</button>
                    </div>
                </div>
                <button class="remove-btn">X</button>
            </div>
            <div class="cart-item">
                <input type="checkbox" class="item-select">
                <img th:src="@{/static-images/product/015.png" alt="상품 이미지">
                <div class="item-info">
                    <p class="item-name">체크리스트 메모지+미니연필</p>
                    <p class="item-price">3,000원</p>
                    <p class="item-option">[옵션: 1 set]</p>
                    <div class="quantity-control">
                        <button class="quantity-btn minus">–</button>
                        <span class="quantity">2</span>
                        <button class="quantity-btn plus">+</button>
                    </div>
                </div>
                <button class="remove-btn">X</button>
            </div>

            <!-- 구분선 추가, 마지막 상품의 경우 구분선 없음 -->
            <!-- <c:if test="${!status.last}">
                <hr style="border: 1px solid black; margin-top: 20px; margin-bottom: 20px;">
            </c:if> -->
        </section>

        <aside class="cart-summary">
            <h3>ORDER</h3>
            <div class="summary-row">
                <span>총 상품 금액</span>
                <span>62,000원</span>
            </div>
            <div class="summary-row">
                <span>배송비</span>
                <span>+ 3,000원</span>
            </div>
            <div class="summary-row total">
                <span>결제 예정 금액</span>
                <span>65,000원</span>
            </div>
            <button class="checkout-btn">결제하기</button>
        </aside>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const decreaseBtns = document.querySelectorAll(".decrease");
            const increaseBtns = document.querySelectorAll(".increase");
            const quantities = document.querySelectorAll(".quantity");

            decreaseBtns.forEach((btn, index) => {
                btn.addEventListener("click", () => {
                    const quantity = parseInt(quantities[index].textContent);
                    if (quantity > 1) quantities[index].textContent = quantity - 1;
                });
            });

            increaseBtns.forEach((btn, index) => {
                btn.addEventListener("click", () => {
                    const quantity = parseInt(quantities[index].textContent);
                    quantities[index].textContent = quantity + 1;
                });
            });
        });

        // checkbox-selectAll script
        document.getElementById('select-all').addEventListener('change', function() {
            var checkboxes = document.querySelectorAll('.item-select');
            checkboxes.forEach(function(checkbox) {
                checkbox.checked = document.getElementById('select-all').checked;
            });
        });

        // 하위 체크박스가 모두 checked 되면 전체 선택이 자동 checked
        var itemCheckboxes = document.querySelectorAll('.item-select');
        itemCheckboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                var allChecked = true;
                itemCheckboxes.forEach(function(checkbox) {
                    if (!checkbox.checked) {
                        allChecked = false;
                    }
                });
                document.getElementById('select-all').checked = allChecked;
            });
        });
    </script>
</body>
</html>